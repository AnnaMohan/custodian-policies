policies:
- name: auto-stop-high-cpu-instances
  resource: ec2
  filters:
  - type: metric
    name: CPUUtilization
    value: 90
    op: greater-than
    aggregation: average
    period: 3600      # 1 hour
  actions:
  - type: notify
    template: default.html
    to:
    - soumya.de@nagarro.com
    subject: ACTION REQUIRED | EC2 Instances having high CPU Utilization
    transport:
      type: sqs
      queue: https://sqs.us-east-1.amazonaws.com/200024982256/MyQueue
  mode:
    type: periodic
    schedule: rate(5 hours)
    role: arn:aws:iam::200024982256:role/custodian
